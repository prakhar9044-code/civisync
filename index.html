<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CiviSync - Smart City Management</title>

<link rel="icon" href="civisync-logo.jpeg" type="image/jpeg">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<link rel="stylesheet" href="style.css">

</head>
<body>

<div id="offline-banner">âš ï¸ You are offline. Reports will be saved locally and synced automatically when connection is restored.</div>

<div class="advisory-marquee hidden" id="global-advisory">
  <div class="advisory-content">
    <span>âš ï¸ <strong>Traffic Alert:</strong> MG Road intersection partially closed due to pending pothole repair. Please reroute.</span>
    <span>ğŸ’§ <strong>Water Advisory:</strong> Low pressure in Sector 15 due to scheduled main pipeline maintenance.</span>
    <span>âš¡ <strong>Safety Alert:</strong> Use caution on Green Avenue C-Block at night; streetlight repair scheduled for next budget cycle.</span>
    <span>ğŸš§ <strong>Community Update:</strong> 12 new NGO volunteers joined the Market Road sanitation drive!</span>
    <span>âš ï¸ <strong>Traffic Alert:</strong> MG Road intersection partially closed due to pending pothole repair. Please reroute.</span>
  </div>
</div>

<nav class="navbar">
  <div class="nav-brand ripple-element" onclick="navigate('landing')">
    <img src="civisync-logo.jpeg" alt="CiviSync Logo">
    <span class="brand-text">Civi<span>Sync</span></span>
  </div>
  
  <div class="nav-links" id="desktop-nav">
    <div class="nav-link active ripple-element" id="nav-landing" onclick="navigate('landing')">Home</div>
    
    <div class="nav-link ripple-element" id="nav-about" onclick="navigate('about')">About Us</div>
    <div class="nav-link ripple-element" id="nav-guidelines" onclick="navigate('guidelines')">Guidelines</div>
    <div class="nav-link ripple-element auth-req hidden" id="nav-leaderboard" onclick="navigate('leaderboard')">ğŸ† Leaderboard</div>
    
    <div class="nav-link ripple-element auth-req hidden" id="nav-report" onclick="navigate('report')">Report Issue</div>
    <div class="nav-link ripple-element auth-req hidden" id="nav-track" onclick="navigate('track')">Track Issues</div>
    <div class="nav-link ripple-element auth-req hidden" id="nav-map" onclick="navigate('map')">Issue Map</div>
    
    <div class="nav-link ripple-element hidden auth-req" id="nav-points" onclick="navigate('points')">Community & Points</div>
    <div class="nav-link ripple-element hidden auth-req" id="nav-ngo" onclick="navigate('ngo')" style="color: var(--purple); font-weight: bold;">NGO Hub</div>
    
    <div class="nav-link ripple-element hidden auth-req" id="nav-admin" onclick="navigate('admin')">Dashboard</div>
    <div class="nav-link ripple-element hidden auth-req" id="nav-budget" onclick="navigate('budget')">Budgeting</div>
  </div>

  <div class="nav-controls">
    <div id="user-points" class="points-badge hidden" onclick="navigate('points')">â­ <span id="pts-val">0</span> pts</div>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">ğŸŒ™</button>
    <button class="btn btn-blue ripple-element" style="border-radius: 50px;" id="btn-auth" onclick="navigate('auth')">Login / Register</button>
    
    <div class="user-menu-container hidden" id="user-menu-container">
      <div class="user-avatar" id="avatar-initials">U</div>
      <div class="dropdown-menu" id="avatar-dropdown">
        <div class="dropdown-header">
          <h4 id="drop-name">User Name</h4>
          <p id="drop-email">user@email.com</p>
        </div>
        <div class="dropdown-item" onclick="navigate('profile')">ğŸ‘¤ My Profile</div>
        <div class="dropdown-item" onclick="navigate('settings')">âš™ï¸ Settings</div>
        <div class="dropdown-divider"></div>
        <div class="dropdown-item" style="color: var(--danger);" onclick="logout()">ğŸšª Logout</div>
      </div>
    </div>
  </div>
</nav>

<main id="app-root">

  <div id="view-landing" class="view active">
    <section class="hero-section">
      <h1 class="hero-title" id="typewriter-text" style="min-height: 140px;">A Smarter Way to Report,<br>Track, and Resolve Civic Issues.</h1>
      
      <p class="hero-subtitle reveal-text delay-1">Empowering citizens with AI-driven routing, transparent budget tracking, and community volunteering to build safer cities together.</p>
      <div class="reveal-text delay-2" style="display: flex; gap: 1rem; justify-content: center;">
        <button class="btn btn-surface ripple-element" style="background: white; color: var(--primary); padding: 0.875rem 2.5rem; font-size: 1.05rem; font-weight: 700; border-radius: 50px; box-shadow: 0 10px 25px rgba(0,0,0,0.15);" onclick="checkAuthAndGo('report')">Report an Issue</button>
        <button class="btn ripple-element" style="background: rgba(255,255,255,0.15); color: white; padding: 0.875rem 2.5rem; font-size: 1.05rem; font-weight: 600; border-radius: 50px; border: 1px solid rgba(255,255,255,0.4); backdrop-filter: blur(5px);" onclick="navigate('track')">View Dashboard</button>
      </div>
    </section>

    <section class="container" style="padding-top: 5rem; padding-bottom: 5rem;">
      <div class="section-title">
        <h2>Next-Generation Civic Technology</h2>
        <p>Going beyond simple reporting by handling real-world municipal challenges like budget constraints and temporary safety measures.</p>
      </div>
      
      <div class="grid-3">
        <div class="feature-card">
          <div class="feature-icon animated-icon">âœ¨</div>
          <h3 style="margin-bottom: 0.75rem;">AI-Assisted Routing</h3>
          <p class="text-muted text-sm">Our system analyzes your issue description in real-time to automatically categorize the problem and route it directly to the correct municipal department.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon animated-icon" style="animation-delay: 0.5s;">ğŸ“Š</div>
          <h3 style="margin-bottom: 0.75rem;">Budget Transparency</h3>
          <p class="text-muted text-sm">Understand exactly why an issue is delayed with clear budget constraint visibility and smart scheduling for upcoming fiscal cycles.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon animated-icon" style="animation-delay: 1s;">ğŸš§</div>
          <h3 style="margin-bottom: 0.75rem;">Preventive Action</h3>
          <p class="text-muted text-sm">Track temporary safety measures applied by authorities (like warning signs) while waiting for full budget approval and resources.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon animated-icon" style="animation-delay: 1.5s;">ğŸ¤</div>
          <h3 style="margin-bottom: 0.75rem;">Community Support</h3>
          <p class="text-muted text-sm">Citizens and NGOs can "Adopt an Issue" to volunteer resources, time, or funds when government budgets fall short.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon animated-icon" style="animation-delay: 2s;">ğŸ—ºï¸</div>
          <h3 style="margin-bottom: 0.75rem;">Real-Time Mapping</h3>
          <p class="text-muted text-sm">Built-in Leaflet.js integration plots every issue on an interactive city map, allowing citizens and admins to visualize problem areas instantly.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon animated-icon" style="animation-delay: 2.5s;">ğŸ“ˆ</div>
          <h3 style="margin-bottom: 0.75rem;">Escalation Reports</h3>
          <p class="text-muted text-sm">Automated, data-driven PDF reports generated for city planners to justify future funding requirements based on citizen demand.</p>
        </div>
      </div>
    </section>

    <section style="background: var(--bg-surface); border-top: 1px solid var(--border); padding: 5rem 0;">
      <div class="container">
        <div class="section-title">
          <h2>How CiviSync Works</h2>
          <p>A seamless, transparent loop from the moment an issue is spotted to the moment it's resolved.</p>
        </div>
        <div class="grid-4" style="position: relative;">
          <div class="step-card">
            <div class="step-number">1</div>
            <h4 style="margin-bottom: 0.5rem;">Spot & Report</h4>
            <p class="text-muted text-sm">Upload a photo, describe the issue via text or voice, and let GPS pinpoint the exact location.</p>
          </div>
          <div class="step-card">
            <div class="step-number">2</div>
            <h4 style="margin-bottom: 0.5rem;">AI Categorization</h4>
            <p class="text-muted text-sm">The system auto-detects the issue type (e.g., Pothole, Water Leak) and flags high-priority hazards.</p>
          </div>
          <div class="step-card">
            <div class="step-number">3</div>
            <h4 style="margin-bottom: 0.5rem;">Authority Action</h4>
            <p class="text-muted text-sm">City admins receive the routed ticket on their dashboard and allocate budgets or deploy teams.</p>
          </div>
          <div class="step-card">
            <div class="step-number">4</div>
            <h4 style="margin-bottom: 0.5rem;">Transparent Update</h4>
            <p class="text-muted text-sm">Citizens get notified, the blockchain log is updated, and the interactive map reflects the fix.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="stats-section">
      <div class="container">
        <div class="grid-3">
          <div class="stat-block"><h3>48h</h3><p class="font-medium text-muted">Average Resolution Time</p></div>
          <div class="stat-block"><h3>12,450+</h3><p class="font-medium text-muted">Issues Successfully Resolved</p></div>
          <div class="stat-block"><h3>85%</h3><p class="font-medium text-muted">Increase in Citizen Trust</p></div>
        </div>
      </div>
    </section>

    <section style="padding: 5rem 0 2rem; overflow: hidden;">
      <div class="section-title">
        <h2>What Our City Says</h2>
        <p>Real feedback from citizens, municipal workers, and community partners.</p>
      </div>
      <div class="testimonial-wrapper">
        <div class="testimonial-track">
          <div class="testimonial-card">
            <div style="color: var(--warning); font-size: 1.2rem; margin-bottom: 0.5rem;">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="text-sm">"This platform is amazing! I reported a broken streetlight using my voice, and it was fixed in just 2 days. The tracking is so transparent."</p>
            <div style="display:flex; align-items:center; gap: 1rem; margin-top: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 50%; display: flex; align-items:center; justify-content:center; color: var(--primary); font-weight: bold;">SL</div>
              <div><h4 style="font-size:0.9rem;">Sarah L.</h4><p class="text-xs text-muted">Local Citizen</p></div>
            </div>
          </div>
          <div class="testimonial-card">
            <div style="color: var(--warning); font-size: 1.2rem; margin-bottom: 0.5rem;">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="text-sm">"As an NGO director, CiviSync helps us find unfunded projects to adopt. The 'Volunteer' button is a game-changer for community action."</p>
            <div style="display:flex; align-items:center; gap: 1rem; margin-top: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--purple-bg); border-radius: 50%; display: flex; align-items:center; justify-content:center; color: var(--purple); font-weight: bold;">GE</div>
              <div><h4 style="font-size:0.9rem;">Green Earth Org</h4><p class="text-xs text-muted">Community Partner</p></div>
            </div>
          </div>
          <div class="testimonial-card">
            <div style="color: var(--warning); font-size: 1.2rem; margin-bottom: 0.5rem;">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="text-sm">"The budget transparency dashboard saves our phone lines. Citizens can actually see *why* a project is delayed to the next cycle."</p>
            <div style="display:flex; align-items:center; gap: 1rem; margin-top: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--danger-bg); border-radius: 50%; display: flex; align-items:center; justify-content:center; color: var(--danger); font-weight: bold;">MT</div>
              <div><h4 style="font-size:0.9rem;">Mark T.</h4><p class="text-xs text-muted">City Planner</p></div>
            </div>
          </div>
          <div class="testimonial-card">
            <div style="color: var(--warning); font-size: 1.2rem; margin-bottom: 0.5rem;">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="text-sm">"Generating automated policy reports in PDF format makes our quarterly budget meetings 10x more efficient. Pure data."</p>
            <div style="display:flex; align-items:center; gap: 1rem; margin-top: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--success-bg); border-radius: 50%; display: flex; align-items:center; justify-content:center; color: var(--success); font-weight: bold;">RJ</div>
              <div><h4 style="font-size:0.9rem;">Rachel J.</h4><p class="text-xs text-muted">Authority Admin</p></div>
            </div>
          </div>
          <div class="testimonial-card">
            <div style="color: var(--warning); font-size: 1.2rem; margin-bottom: 0.5rem;">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="text-sm">"This platform is amazing! I reported a broken streetlight using my voice, and it was fixed in just 2 days. The tracking is so transparent."</p>
            <div style="display:flex; align-items:center; gap: 1rem; margin-top: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 50%; display: flex; align-items:center; justify-content:center; color: var(--primary); font-weight: bold;">SL</div>
              <div><h4 style="font-size:0.9rem;">Sarah L.</h4><p class="text-xs text-muted">Local Citizen</p></div>
            </div>
          </div>
          <div class="testimonial-card">
            <div style="color: var(--warning); font-size: 1.2rem; margin-bottom: 0.5rem;">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="text-sm">"As an NGO director, CiviSync helps us find unfunded projects to adopt. The 'Volunteer' button is a game-changer for community action."</p>
            <div style="display:flex; align-items:center; gap: 1rem; margin-top: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--purple-bg); border-radius: 50%; display: flex; align-items:center; justify-content:center; color: var(--purple); font-weight: bold;">GE</div>
              <div><h4 style="font-size:0.9rem;">Green Earth Org</h4><p class="text-xs text-muted">Community Partner</p></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section style="padding: 5rem 2rem; text-align: center;">
      <h2 style="font-size: 2.25rem; margin-bottom: 1rem;">Ready to transform your city?</h2>
      <p class="text-muted" style="margin-bottom: 2rem;">Join thousands of citizens actively improving their neighborhoods today.</p>
      <button class="btn btn-blue ripple-element" style="padding: 1rem 2.5rem; font-size: 1.1rem; border-radius: 50px;" onclick="navigate('auth')">Create Your Citizen Account</button>
    </section>

    <footer class="footer">
      <div class="footer-grid">
        <div>
          <div class="nav-brand" style="color: white; margin-bottom: 1rem;">
            <img src="civisync-logo.jpeg" alt="Logo" style="height:35px; margin-right:8px; filter: brightness(0) invert(1);"> 
            CiviSync
          </div>
          <p class="text-sm" style="line-height: 1.6; max-width: 300px;">A comprehensive, transparent, and AI-driven platform designed to bridge the gap between citizens, NGOs, and municipal authorities.</p>
        </div>
        <div>
          <h4 class="footer-heading">Platform</h4>
          <ul class="footer-links text-sm">
            <li><a href="#" onclick="navigate('report')">Report Issue</a></li>
            <li><a href="#" onclick="navigate('track')">Track Dashboard</a></li>
            <li><a href="#" onclick="navigate('auth')">Admin Portal</a></li>
          </ul>
        </div>
        <div>
          <h4 class="footer-heading">Resources</h4>
          <ul class="footer-links text-sm">
            <li><a href="#" onclick="navigate('about')">About Us</a></li>
            <li><a href="#" onclick="navigate('guidelines')">City Guidelines</a></li>
            <li><a href="#">Privacy Policy</a></li>
          </ul>
        </div>
        <div>
          <h4 class="footer-heading">Contact</h4>
          <ul class="footer-links text-sm">
            <li>support@civisync.gov</li>
            <li>Emergency: 911</li>
            <li>Non-Emergency: 311</li>
          </ul>
        </div>
      </div>
      <div style="text-align: center; padding-top: 2rem; font-size: 0.875rem;">
        &copy; 2026 CiviSync Platform. All rights reserved.
      </div>
    </footer>
  </div>

  <div id="view-about" class="view container">
    <div style="text-align: center; margin-bottom: 3rem;">
      <h2 style="font-size: 2.5rem; color: var(--primary);">About CiviSync</h2>
      <p class="text-muted mt-2">Bridging the gap between the community and municipal authorities.</p>
    </div>
    <div class="card" style="max-width: 800px; margin: 0 auto; line-height: 1.8;">
      <h3 style="margin-bottom: 1rem;">Our Mission</h3>
      <p class="text-muted" style="margin-bottom: 1.5rem;">CiviSync was built with a simple goal: to make urban management transparent, efficient, and community-driven. By leveraging AI to categorize reports, transparent budget tracking to explain delays, and real-time mapping, we empower every citizen to take an active role in bettering their environment.</p>
      
      <h3 style="margin-bottom: 1rem;">Why CiviSync?</h3>
      <ul style="list-style: disc; margin-left: 1.5rem; color: var(--text-secondary); margin-bottom: 1.5rem;">
        <li>AI eliminates bureaucracy by automatically routing issues to the correct department.</li>
        <li>Immutable audit trails ensure transparency in how your tax dollars are spent.</li>
        <li>The NGO & Volunteer hub allows the community to step up when government budgets are tight.</li>
      </ul>
      <p class="text-muted">Developed to create smarter, safer, and more connected cities.</p>
    </div>
  </div>

  <div id="view-guidelines" class="view container">
    <div style="text-align: center; margin-bottom: 3rem;">
      <h2>City Reporting Guidelines</h2>
      <p class="text-muted mt-2">How to accurately report issues for the fastest resolution.</p>
    </div>
    <div class="grid-2">
      <div class="card">
        <h3 style="color: var(--success); margin-bottom: 1rem;">âœ… DO:</h3>
        <ul style="list-style: none; display: flex; flex-direction: column; gap: 0.8rem; color: var(--text-secondary);">
          <li><strong>Take Clear Photos:</strong> Ensure the issue is visible and well-lit.</li>
          <li><strong>Use Exact Locations:</strong> Rely on the Auto-Locate GPS feature whenever possible.</li>
          <li><strong>Be Descriptive:</strong> Mention size, severity, and potential risks (e.g., "Deep 2ft pothole causing tire damage").</li>
          <li><strong>Check for Duplicates:</strong> Browse the Track page to see if your neighbor already reported it. Upvote theirs instead!</li>
        </ul>
      </div>
      <div class="card">
        <h3 style="color: var(--danger); margin-bottom: 1rem;">âŒ DON'T:</h3>
        <ul style="list-style: none; display: flex; flex-direction: column; gap: 0.8rem; color: var(--text-secondary);">
          <li><strong>Report Emergencies Here:</strong> For fires, immediate crimes, or medical emergencies, dial 911 immediately.</li>
          <li><strong>Submit Blurred Photos:</strong> Images taken from moving cars are often rejected by our AI verification.</li>
          <li><strong>Use Offensive Language:</strong> Descriptions are public and moderation will result in a ban.</li>
          <li><strong>Spam the System:</strong> Submitting the exact same issue multiple times slows down the entire department.</li>
        </ul>
      </div>
    </div>
  </div>

  <div id="view-leaderboard" class="view container">
    <div style="text-align: center; margin-bottom: 3rem;">
      <h2>ğŸ† Civic Leaderboard</h2>
      <p class="text-muted mt-2">Recognizing our most active and helpful community members.</p>
    </div>
    <div class="card" style="max-width: 800px; margin: 0 auto; overflow: hidden; padding: 0;">
      <table style="width: 100%; border-collapse: collapse; text-align: left;">
        <thead style="background: var(--bg-app);">
          <tr>
            <th style="padding: 1.5rem; color: var(--text-secondary);">Rank</th>
            <th style="padding: 1.5rem; color: var(--text-secondary);">Citizen / NGO</th>
            <th style="padding: 1.5rem; color: var(--text-secondary);">Issues Fixed</th>
            <th style="padding: 1.5rem; color: var(--text-secondary);">Civic Points</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 1.5rem; font-size: 1.5rem;">ğŸ¥‡</td>
            <td style="padding: 1.5rem; font-weight: bold;">Green Earth Org</td>
            <td style="padding: 1.5rem;">42</td>
            <td style="padding: 1.5rem; color: var(--warning); font-weight: bold;">4,200</td>
          </tr>
          <tr>
            <td style="padding: 1.5rem; font-size: 1.5rem;">ğŸ¥ˆ</td>
            <td style="padding: 1.5rem; font-weight: bold;">Sarah Jenkins</td>
            <td style="padding: 1.5rem;">28</td>
            <td style="padding: 1.5rem; color: var(--warning); font-weight: bold;">2,850</td>
          </tr>
          <tr>
            <td style="padding: 1.5rem; font-size: 1.5rem;">ğŸ¥‰</td>
            <td style="padding: 1.5rem; font-weight: bold;">Marcus T.</td>
            <td style="padding: 1.5rem;">19</td>
            <td style="padding: 1.5rem; color: var(--warning); font-weight: bold;">1,900</td>
          </tr>
          <tr style="background: var(--primary-light);">
            <td style="padding: 1.5rem; font-weight: bold; color: var(--primary);">4</td>
            <td style="padding: 1.5rem; font-weight: bold; color: var(--primary);" id="lb-current-user">You</td>
            <td style="padding: 1.5rem; color: var(--primary);" id="lb-current-issues">0</td>
            <td style="padding: 1.5rem; color: var(--primary); font-weight: bold;" id="lb-current-points">150</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div id="view-auth" class="view container">
    <div style="max-width: 480px; margin: 3rem auto;">
      <div class="auth-card">
        <div style="display: flex; margin-bottom: 2rem; border-bottom: 2px solid var(--bg-app); padding-bottom: 0.5rem;">
          <button class="btn ripple-element" style="flex:1; background:none; color:var(--primary); font-weight:700; font-size:1.1rem; border-bottom: 3px solid var(--primary); border-radius:0;" id="tab-cit" onclick="switchAuthTab('citizen')">Citizen View</button>
          <button class="btn ripple-element" style="flex:1; background:none; color:var(--text-secondary); font-weight:600; font-size:1.1rem; border-bottom: 3px solid transparent; border-radius:0;" id="tab-adm" onclick="switchAuthTab('admin')">Authority</button>
        </div>

        <div id="area-cit" class="auth-animate">
          <div class="auth-sub-tabs" style="display:flex; background:var(--bg-app); border-radius:var(--radius-md); padding:0.35rem; margin-bottom:2rem;">
            <button id="btn-login-cit" class="active ripple-element" style="flex:1; padding:0.75rem; border:none; border-radius:var(--radius-sm); font-weight:600; background:var(--bg-surface); color:var(--primary); box-shadow:var(--shadow-sm);" onclick="toggleCitAuth('login')">Log In</button>
            <button id="btn-reg-cit" class="ripple-element" style="flex:1; padding:0.75rem; border:none; border-radius:var(--radius-sm); font-weight:600; background:transparent; color:var(--text-secondary);" onclick="toggleCitAuth('register')">Register</button>
          </div>

          <form id="form-cit-login" class="auth-animate" onsubmit="handleAuth(event, 'citizen')">
            <h3 style="margin-bottom: 0.5rem; font-size: 1.5rem;">Welcome Back ğŸ‘‹</h3>
            <p class="text-muted text-sm" style="margin-bottom: 2rem;">Log in to track your issues and volunteer.</p>
            <div class="form-group"><label class="form-label">Email Address</label><input type="email" class="form-control" placeholder="citizen@city.com" required></div>
            <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required></div>
            <button type="submit" class="btn btn-blue ripple-element" style="width: 100%; padding: 0.9rem; font-size: 1rem; border-radius: 50px;">Log In</button>
          </form>

          <form id="form-cit-register" class="hidden auth-animate" onsubmit="handleAuth(event, 'citizen')">
            <h3 style="margin-bottom: 0.5rem; font-size: 1.5rem;">Join CiviSync ğŸŒŸ</h3>
            <p class="text-muted text-sm" style="margin-bottom: 2rem;">Create an account to improve your neighborhood.</p>
            <div class="form-group"><label class="form-label">Full Name</label><input type="text" class="form-control" required placeholder="E.g. Prakhar"></div>
            <div class="form-group"><label class="form-label">Email Address</label><input type="email" class="form-control" required placeholder="prakhar@example.com"></div>
            <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-control" required></div>
            <button type="submit" class="btn btn-blue ripple-element" style="width: 100%; padding: 0.9rem; font-size: 1rem; border-radius: 50px;">Register Now</button>
          </form>
        </div>

        <form id="form-adm" class="hidden auth-animate" onsubmit="handleAuth(event, 'admin')">
          <h3 style="margin-bottom: 0.5rem; font-size: 1.5rem;">Authority Access ğŸ›¡ï¸</h3>
          <p class="text-muted text-sm" style="margin-bottom: 2rem;">Access the municipal management & budget dashboard.</p>
          <div class="form-group"><label class="form-label">Admin ID / Name</label><input type="text" value="City Admin" class="form-control" required></div>
          <div class="form-group"><label class="form-label">Master Password</label><input type="password" value="admin123" class="form-control" required></div>
          <button type="submit" class="btn btn-blue ripple-element" style="width: 100%; padding: 0.9rem; font-size: 1rem; border-radius: 50px; background: linear-gradient(90deg, #1e3a8a, #3b82f6);">Access Dashboard</button>
        </form>
      </div>
    </div>
  </div>

  <div id="view-profile" class="view container">
    <div style="margin-bottom: 2rem;">
      <h2>ğŸ‘¤ My Profile</h2>
      <p class="text-muted text-sm">Manage your personal information and civic track record.</p>
    </div>
    
    <div class="grid-2">
      <div class="card" style="text-align: center; padding: 3rem 1.5rem;">
        <div id="prof-avatar" style="width: 100px; height: 100px; background: linear-gradient(135deg, var(--primary), var(--purple)); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: bold; margin: 0 auto 1.5rem; box-shadow: var(--shadow-md);">U</div>
        <h2 id="prof-name" style="margin-bottom: 0.5rem;">User Name</h2>
        <p id="prof-email" class="text-muted" style="margin-bottom: 1.5rem;">user@email.com</p>
        <div class="badge badge-in-progress" id="prof-role-badge" style="font-size: 1rem; padding: 0.5rem 1rem;">Citizen</div>
      </div>
      
      <div class="card">
        <h3 style="margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.75rem;">Civic Impact</h3>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 1rem; background: var(--bg-app); border-radius: var(--radius-md);">
          <span class="text-muted font-medium">Total Points Earned</span>
          <strong id="prof-pts" style="color: var(--warning); font-size: 1.5rem;">0</strong>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 1rem; border: 1px solid var(--border); border-radius: var(--radius-md);">
          <span class="text-muted font-medium">Issues Reported</span>
          <strong id="prof-reported" style="font-size: 1.5rem;">0</strong>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 1rem; background: var(--purple-bg); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: var(--radius-md);">
          <span class="text-purple font-medium">Volunteered Projects</span>
          <strong id="prof-vol" style="color: var(--purple); font-size: 1.5rem;">0</strong>
        </div>
      </div>
    </div>
  </div>

  <div id="view-settings" class="view container">
    <div style="margin-bottom: 2rem;">
      <h2>âš™ï¸ Account Settings</h2>
      <p class="text-muted text-sm">Customize your platform experience.</p>
    </div>
    
    <div class="card" style="max-width: 600px;">
      <h3 style="margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 0.75rem;">Preferences</h3>
      
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <div>
          <strong>Dark Mode</strong>
          <p class="text-xs text-muted">Toggle dark theme for the interface.</p>
        </div>
        <button class="btn btn-outline ripple-element" onclick="toggleTheme()">Toggle Theme ğŸŒ“</button>
      </div>
      
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <div>
          <strong>Email Notifications</strong>
          <p class="text-xs text-muted">Receive updates on your reported issues.</p>
        </div>
        <input type="checkbox" checked style="width: 20px; height: 20px; accent-color: var(--primary); cursor: pointer;">
      </div>
      
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <div>
          <strong>Location Services</strong>
          <p class="text-xs text-muted">Allow auto-fetching GPS coordinates.</p>
        </div>
        <input type="checkbox" checked style="width: 20px; height: 20px; accent-color: var(--primary); cursor: pointer;">
      </div>
      
      <button class="btn btn-blue ripple-element" style="width: 100%; border-radius: 50px; margin-top: 1rem;" onclick="alert('Settings saved successfully!')">Save Settings</button>
    </div>
  </div>

  <div id="view-report" class="view container">
    <div style="text-align: center; margin-bottom: 2rem;">
      <h2>ğŸ“ Report an Issue</h2>
      <p class="text-muted text-sm" style="margin-top: 0.5rem;">Help us make your city better. All fields marked with * are required.</p>
    </div>

    <div class="card" style="max-width: 800px; margin: 0 auto;">
      <form onsubmit="submitReport(event)">
        <div class="form-group">
          <label class="form-label">Issue Title *</label>
          <input type="text" id="repTitle" class="form-control" placeholder="e.g., Large pothole on Main Street" required>
        </div>
        <div class="form-group" style="position:relative;">
          <label class="form-label">Description * <span class="text-xs text-muted font-medium">(Type or use Voice)</span></label>
          <textarea id="repDesc" class="form-control" placeholder="Describe the issue in detail..." required oninput="triggerAICategorization()"></textarea>
          <button type="button" class="mic-btn ripple-element" id="btnMic" onclick="startDictation()" title="Click to speak" style="position:absolute; right:10px; top:35px; border-radius:50%; padding:0.5rem;">ğŸ¤</button>
        </div>
        <div class="form-group" style="position: relative;">
          <label class="form-label">Category *</label>
          <select id="repCat" class="form-control" required>
            <option value="">Select issue category</option>
            <option value="Pothole">ğŸ•³ï¸ Pothole</option>
            <option value="Water Leak">ğŸ’§ Water Leak</option>
            <option value="Electrical">âš¡ Electrical</option>
            <option value="Garbage">ğŸ—‘ï¸ Garbage</option>
            <option value="Drainage">ğŸŒŠ Drainage</option>
            <option value="Traffic">ğŸš¥ Traffic</option>
          </select>
          <span id="aiTag" class="ai-tag">âœ¨ AI Auto-Selected</span>
        </div>
        <div class="form-group">
          <label class="form-label">Location *</label>
          <div style="display: flex; gap: 1rem;">
            <input type="text" id="repLoc" class="form-control" placeholder="Tap 'Get Location' or enter manually" required>
            <button type="button" class="btn btn-blue ripple-element" style="flex-shrink: 0; border-radius: 8px;" onclick="getLocation()">ğŸ“ Auto Locate</button>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Upload Images (Max 5)</label>
          <div class="file-upload-box" onclick="document.getElementById('repFile').click()">
            <input type="file" id="repFile" accept="image/*" style="display:none;" onchange="handleImageUpload(event)">
            <div class="animated-icon" style="font-size: 2.5rem; color: var(--text-secondary); margin-bottom: 0.5rem;">ğŸ“¸</div>
            <p class="font-medium">Click to upload or drag and drop</p>
            <p id="uploadStatus" class="text-sm" style="color: var(--primary); margin-top: 1rem; font-weight: 600;"></p>
          </div>
        </div>
        <button type="submit" class="btn btn-blue ripple-element" style="width: 100%; padding: 1rem; font-size: 1.05rem; border-radius: 50px;">ğŸš€ Submit Issue Report</button>
      </form>
    </div>
  </div>

  <div id="view-track" class="view container">
    <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 1.5rem;">
      <div>
        <h2>ğŸ“‹ Track Issues & Advisories</h2>
        <p class="text-muted text-sm" style="margin-top: 0.25rem;">Monitor issue status, budget approvals, and temporary safety actions.</p>
      </div>
      <div style="display: flex; background: var(--bg-surface); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 0.25rem; box-shadow: var(--shadow-sm);">
        <button class="btn" id="btn-list-view" style="background: var(--bg-app); color: var(--primary); font-weight:600;" onclick="switchTrackView('list')">Grid View</button>
        <button class="btn" id="btn-map-view" style="background: transparent; color: var(--text-secondary);" onclick="switchTrackView('map')">Map View</button>
      </div>
    </div>

    <div class="filter-bar">
      <div style="flex: 1; display: flex; align-items: center; background: var(--bg-app); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 0 1rem;">
        <span>ğŸ”</span><input type="text" id="trackSearch" placeholder="Search issues..." style="border:none; background:transparent; width:100%; padding:0.875rem; outline:none; color:var(--text-primary);" oninput="renderTrack()">
      </div>
      <select id="trackCatFilter" class="form-control" style="width: 200px;" onchange="renderTrack()">
        <option value="">All Categories</option>
        <option value="Pothole">Pothole</option>
        <option value="Water Leak">Water Leak</option>
        <option value="Electrical">Electrical</option>
        <option value="Garbage">Garbage</option>
        <option value="Drainage">Drainage</option>
        <option value="Traffic">Traffic</option>
      </select>
    </div>

    <div class="tabs-pill" style="margin-bottom: 1.5rem; display: inline-flex;">
      <div class="tab-pill active ripple-element" onclick="setTrackTab('All', this)">All <span id="cnt-all" style="margin-left:0.5rem; opacity:0.7;">0</span></div>
      <div class="tab-pill ripple-element" onclick="setTrackTab('pending', this)">Pending <span id="cnt-pen" style="margin-left:0.5rem; opacity:0.7;">0</span></div>
      <div class="tab-pill ripple-element" onclick="setTrackTab('in progress', this)">In Progress <span id="cnt-prog" style="margin-left:0.5rem; opacity:0.7;">0</span></div>
      <div class="tab-pill ripple-element" onclick="setTrackTab('resolved', this)">Resolved <span id="cnt-res" style="margin-left:0.5rem; opacity:0.7;">0</span></div>
    </div>

    <div id="track-list-container" class="issue-grid"></div>
    <div id="track-map-container" class="hidden"><div id="leaflet-map"></div></div>
  </div>

  <div id="view-map" class="view container">
    <div style="margin-bottom: 2rem;">
      <h2>ğŸ—ºï¸ Full City Issue Map</h2>
      <p class="text-muted text-sm">Explore all active issues and digital advisories across the city.</p>
    </div>
    <div class="card" style="padding: 0; overflow: hidden;"><div id="dedicated-map"></div></div>
  </div>

  <div id="view-points" class="view container">
    <div style="text-align: center; margin-bottom: 2rem;">
      <h2>â­ Community & Rewards</h2>
      <p class="text-muted text-sm">Earn points for bettering your city and redeem them for rewards.</p>
    </div>
    <div class="card" style="max-width: 600px; margin: 0 auto; text-align: center;">
      <h3 class="text-muted">Your Civic Points</h3>
      <h1 style="font-size: 4rem; color: var(--warning); margin: 1rem 0;"><span id="manage-pts">0</span></h1>
      <button class="btn btn-blue ripple-element" style="border-radius:50px; padding:0.75rem 2rem;" onclick="navigate('ngo')">View Volunteer Opportunities</button>
      
      <div style="text-align: left; margin-top: 2rem; border-top: 1px solid var(--border); padding-top: 1.5rem;">
        <h4 style="margin-bottom: 1rem;">Redeem Rewards</h4>
        <div style="display:flex; justify-content:space-between; align-items:center; background:var(--bg-app); padding:1rem; border-radius:var(--radius-md); margin-bottom:1rem; transition: transform 0.2s; cursor: pointer;">
          <div><strong>1 Day Free Metro Pass</strong><div class="text-xs text-muted">Valid across all lines</div></div>
          <button class="btn btn-outline ripple-element" style="border-radius: 50px;">50 pts</button>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; background:var(--bg-app); padding:1rem; border-radius:var(--radius-md); margin-bottom:1rem; transition: transform 0.2s; cursor: pointer;">
          <div><strong>Public Library Premium Access</strong><div class="text-xs text-muted">Skip the queues</div></div>
          <button class="btn btn-outline ripple-element" style="border-radius: 50px;">100 pts</button>
        </div>
      </div>
    </div>
  </div>

  <div id="view-ngo" class="view container">
    <div style="margin-bottom: 2rem; text-align: center;">
      <h2 style="color: var(--purple);">ğŸ¤ NGO & Community Partner Hub</h2>
      <p class="text-muted text-sm">Review municipal budget shortages and pledge funds or volunteers directly to pending civic issues.</p>
    </div>

    <div class="grid-3" style="margin-bottom: 2rem;">
      <div class="card" style="border-color: var(--purple); background: var(--purple-bg); text-align: center;">
        <h3 style="color: var(--purple); font-size: 2.5rem;">12</h3>
        <p class="text-sm font-semibold">Active NGOs Registered</p>
      </div>
      <div class="card" style="text-align: center;">
        <h3 style="color: var(--success); font-size: 2.5rem;">â‚¹450K</h3>
        <p class="text-sm font-semibold text-muted">Total Funds Pledged</p>
      </div>
      <div class="card" style="text-align: center;">
        <h3 style="color: var(--primary); font-size: 2.5rem;">340</h3>
        <p class="text-sm font-semibold text-muted">Volunteer Hours Logged</p>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <span class="card-title">Issues Awaiting Community Adoption</span>
        <span class="badge badge-outline">Budget Constrained Issues Only</span>
      </div>
      <div class="issue-grid" id="ngo-issue-list">
        </div>
    </div>
  </div>

  <div id="view-budget" class="view container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
      <div>
        <h2>ğŸ’° Municipal Budget Management</h2>
        <p class="text-muted text-sm">Review delayed issues and approve funds to move them to 'In Progress'.</p>
      </div>
      <button class="btn btn-outline ripple-element" style="border-radius: 50px;" onclick="navigate('admin')">â¬…ï¸ Back to Admin</button>
    </div>

    <div class="grid-3" style="margin-bottom: 2rem;">
      <div class="card">
        <p class="text-xs text-muted">Total Annual Budget</p>
        <h2 style="font-size:2rem;">â‚¹1.5M</h2>
      </div>
      <div class="card">
        <p class="text-xs text-muted">Allocated Funds</p>
        <h2 style="font-size:2rem; color:var(--success);">â‚¹1.1M</h2>
      </div>
      <div class="card">
        <p class="text-xs text-muted">Available Reserve</p>
        <h2 style="font-size:2rem; color:var(--primary);">â‚¹400K</h2>
      </div>
    </div>

    <div class="card">
      <div class="card-header"><span class="card-title">Pending Budget Approvals</span></div>
      <div style="overflow-x: auto;">
        <table>
          <thead><tr><th>ID</th><th>Issue Details</th><th>Department</th><th>Est. Cost</th><th>Action</th></tr></thead>
          <tbody id="budget-approval-table">
            </tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="view-admin" class="view container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
      <div>
        <h2>ğŸ›¡ï¸ Authority Dashboard</h2>
        <p class="text-muted text-sm">Manage issues, track department performance, and generate escalation reports.</p>
      </div>
      <div style="display: flex; gap: 1rem;">
        <button class="btn btn-outline ripple-element" style="border-radius: 50px;" onclick="navigate('budget')">Manage Budgets</button>
        <button class="btn btn-blue ripple-element" style="border-radius: 50px;" onclick="navigate('analytics')">ğŸ“Š Analytics</button>
      </div>
    </div>

    <div class="card" style="background: linear-gradient(135deg, var(--bg-surface), var(--primary-light)); border-color: var(--primary); margin-bottom: 2rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <h3 style="color: var(--primary); margin-bottom: 0.5rem;">ğŸ“„ Policy & Budget Escalation Reports</h3>
          <p class="text-sm text-muted">Generate data-driven PDFs highlighting high-frequency issues and budget shortages to present at city planning meetings.</p>
        </div>
        <button class="btn btn-primary ripple-element" style="border-radius: 8px; padding: 0.8rem 1.5rem;" onclick="generatePDFReport()">Download Needs Report (.PDF)</button>
      </div>
    </div>

    <div id="pdf-content" class="hidden" style="padding: 40px; background: white; color: black; width: 800px; font-family: 'Helvetica', sans-serif;">
      <div style="display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">
        <h1 style="color: #2563eb; margin: 0;">CiviSync Escalation Report</h1>
        <p style="margin: 0; color: #64748b;"><strong>Generated:</strong> <span id="pdf-date"></span></p>
      </div>
      
      <h3 style="margin-top: 30px; color: #1e293b;">Executive Summary</h3>
      <p style="line-height: 1.6; color: #334155;">This automated document highlights critical civic issues that are currently delayed due to verified municipal budget constraints. Escalation and immediate funding review is recommended for the following high-priority items to ensure citizen safety and infrastructure integrity.</p>
      
      <h3 style="margin-top: 30px; color: #ef4444; border-left: 4px solid #ef4444; padding-left: 10px;">High Priority & Budget Delayed Issues</h3>
      <table style="width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px;">
        <thead>
          <tr style="background: #f8fafc; text-align: left;">
            <th style="padding: 12px; border: 1px solid #e2e8f0;">Issue ID</th>
            <th style="padding: 12px; border: 1px solid #e2e8f0;">Issue Description</th>
            <th style="padding: 12px; border: 1px solid #e2e8f0;">Assigned Department</th>
            <th style="padding: 12px; border: 1px solid #e2e8f0;">Budget Status</th>
          </tr>
        </thead>
        <tbody id="pdf-table-body">
          </tbody>
      </table>
      
      <p style="margin-top: 40px; font-size: 12px; color: #94a3b8; text-align: center; border-top: 1px solid #e2e8f0; padding-top: 10px;">Document generated automatically by the CiviSync Smart City Platform.</p>
    </div>

    <div class="admin-top-stats" id="admin-stats-top"></div>

    <div class="grid-2">
      <div class="card">
        <div class="card-header">
          <span class="card-title">High Priority / Budget Delayed</span>
          <span class="badge badge-high" id="hp-count-badge">0 Active</span>
        </div>
        <div id="admin-hp-list" class="hp-issue-list"></div>
      </div>
      <div class="card">
        <div class="card-header"><span class="card-title">Department Budget Usage</span></div>
        <div id="admin-dept-progress" class="dept-perf-list"></div>
      </div>
    </div>

    <div class="card" style="margin-top: 1.5rem;">
      <div class="card-header">
        <span class="card-title">Recent Issues Log</span>
        <button class="btn btn-outline text-xs ripple-element" style="border-radius: 50px;" onclick="navigate('track')">View All â†—</button>
      </div>
      <div style="overflow-x: auto;">
        <table>
          <thead><tr><th>ID</th><th>Title</th><th>Budget Status</th><th>Process Status</th><th>Actions</th></tr></thead>
          <tbody id="admin-table-body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="view-analytics" class="view container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
      <div>
        <h2>ğŸ“ˆ Analytics Dashboard</h2>
        <p class="text-muted text-sm">Data visualizations for policy review and resource allocation.</p>
      </div>
      <button class="btn btn-outline ripple-element" style="border-radius: 50px;" onclick="navigate('admin')">â¬…ï¸ Back to Admin</button>
    </div>
    
    <div class="grid-4" style="margin-bottom: 2rem;">
      <div class="card"><div style="display:flex; gap:1rem; align-items:center;"><div class="icon-circle" style="background:var(--primary-light); color:var(--primary);">ğŸ“ˆ</div><div><p class="text-xs text-muted">Resolution Rate</p><h3 id="an-rate" style="font-size:1.5rem;">0%</h3></div></div></div>
      <div class="card"><div style="display:flex; gap:1rem; align-items:center;"><div class="icon-circle" style="background:rgba(168,85,247,0.15); color:#a855f7;">â±ï¸</div><div><p class="text-xs text-muted">Avg Response Time</p><h3 style="font-size:1.5rem;">4.2h</h3></div></div></div>
      <div class="card"><div style="display:flex; gap:1rem; align-items:center;"><div class="icon-circle" style="background:var(--warning-bg); color:var(--warning);">ğŸ“</div><div><p class="text-xs text-muted">Active Hotspots</p><h3 style="font-size:1.5rem;">5</h3></div></div></div>
      <div class="card"><div style="display:flex; gap:1rem; align-items:center;"><div class="icon-circle" style="background:var(--danger-bg); color:var(--danger);">âš ï¸</div><div><p class="text-xs text-muted">High Priority</p><h3 id="an-hp" style="font-size:1.5rem;">0</h3></div></div></div>
    </div>

    <div class="grid-2">
      <div class="card">
        <div class="card-header"><span class="card-title">Status Distribution</span></div>
        <div class="chart-container"><canvas id="chart-status"></canvas></div>
      </div>
      <div class="card">
        <div class="card-header"><span class="card-title">Priority Distribution</span></div>
        <div class="chart-container"><canvas id="chart-priority"></canvas></div>
      </div>
    </div>
    
    <div class="card" style="margin-top:1.5rem;">
      <div class="card-header"><span class="card-title">Issues by Category</span></div>
      <div class="chart-container" style="height: 300px;"><canvas id="chart-categories"></canvas></div>
    </div>
  </div>
</main>

<div class="modal-overlay" id="modal">
  <div class="modal">
    <div class="modal-header">
      <div>
        <h3 id="mod-title">Issue Title</h3>
        <p class="text-xs text-muted" style="margin-top:0.25rem;">ID: <span id="mod-id" class="table-id"></span> | Reported: <span id="mod-time"></span></p>
        <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem;">
          <span class="badge badge-outline" id="mod-cat"></span>
          <span id="mod-prio"></span>
          <span id="mod-stat"></span>
        </div>
      </div>
      <button class="btn btn-outline" style="border:none; padding:0.5rem;" onclick="closeModal()">âœ•</button>
    </div>
    <div class="modal-body">
      
      <div id="mod-temp-sec"></div>

      <img id="mod-img" src="" style="width:100%; height:250px; object-fit:cover; border-radius:var(--radius-md); margin-bottom:1.5rem; border:1px solid var(--border); box-shadow: var(--shadow-sm);" onerror="this.src='https://images.unsplash.com/photo-1515162816999-a0c47dc192f7?auto=format&fit=crop&w=600&q=80'">
      
      <div class="budget-box">
        <h4 style="font-size:0.875rem; margin-bottom:0.5rem; color:var(--text-primary);">ğŸ’° Financial & Schedule Status</h4>
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <span id="mod-budget-badge"></span>
          <span id="mod-schedule" class="text-sm font-medium text-muted"></span>
        </div>
      </div>

      <p class="text-sm font-semibold" style="margin-bottom:0.25rem;">Description</p>
      <p id="mod-desc" class="text-sm text-muted" style="margin-bottom:1rem; line-height:1.6;"></p>

      <div class="volunteer-box">
        <div>
          <h4 style="font-size:0.875rem; color:var(--purple); margin-bottom:0.25rem;">ğŸ¤ Community Action Needed</h4>
          <p class="text-xs text-muted">Government funds are constrained. <span id="mod-vol-count">0</span> citizens have volunteered to help fix this.</p>
        </div>
        <button class="btn ripple-element" style="background:var(--purple); color:white; border-radius:50px; font-size:0.8rem;" onclick="volunteerForIssue()">Volunteer / Adopt</button>
      </div>

      <div style="display:flex; justify-content:space-between; align-items:center; border-top:1px solid var(--border); padding-top:1rem; margin-top:1rem;">
        <p class="text-xs text-muted">Auto-Assigned to: <strong id="mod-dept" style="color:var(--text-primary);"></strong></p>
        <button class="btn btn-blue text-xs ripple-element" style="border-radius: 50px;" onclick="upvoteIssue()" id="mod-upvote">â¬† Upvote (<span id="mod-upv-cnt"></span>)</button>
      </div>

      <div id="admin-update-area" class="hidden" style="margin-top:1.5rem; padding-top:1.5rem; border-top:1px solid var(--border);">
        <h4 style="font-size:0.875rem; margin-bottom:1rem;">Authority Controls</h4>
        <div style="display:flex; gap:0.5rem; margin-bottom:1rem;">
          <select id="admin-sel-stat" class="form-control" style="flex:1;">
            <option value="pending">Pending</option>
            <option value="in progress">In Progress</option>
            <option value="resolved">Resolved</option>
          </select>
          <select id="admin-sel-budget" class="form-control" style="flex:1;">
            <option value="Funded">Funded</option>
            <option value="Pending Budget Constraint">Pending Budget Constraint</option>
            <option value="Scheduled for Next Cycle">Scheduled Next Cycle</option>
          </select>
        </div>
        <button class="btn btn-blue ripple-element" style="border-radius: 50px; width:100%;" onclick="adminSaveStatus()">Save & Update Audit Trail</button>
      </div>
    </div>
  </div>
</div>

<div class="chatbot-wrapper">
  <button class="chat-toggle-btn ripple-element" onclick="toggleChat()">ğŸ’¬</button>
  <div id="chat-window" class="chat-window hidden">
    <div class="chat-header">
      <span>ğŸ¤– CiviBot Assistant</span>
      <button onclick="toggleChat()" style="background:none; color:white; font-size:1.2rem; border:none; cursor:pointer;">âœ•</button>
    </div>
    <div class="chat-body" id="chat-body">
      <div class="chat-msg msg-bot">
        Hi there! I can help you report issues, explain budget delays, or find volunteer opportunities. Try tapping a quick reply below or type your question.
        <div class="chat-quick-replies">
          <button class="chat-chip" onclick="quickReply('How do I report an issue?')">Report Issue</button>
          <button class="chat-chip" onclick="quickReply('Why is my issue delayed?')">Budget Delays</button>
          <button class="chat-chip" onclick="quickReply('How can I volunteer?')">Volunteer</button>
        </div>
      </div>
    </div>
    <div class="chat-input-area">
      <input type="text" id="chat-msg" class="form-control" placeholder="Ask about budgets, reports, safety..." style="border-radius: 50px; padding: 0.75rem 1.25rem;" onkeypress="if(event.key==='Enter') sendChat()">
      <button class="btn btn-blue ripple-element" style="border-radius: 50%; width: 45px; height: 45px; padding: 0; display: flex; align-items: center; justify-content: center;" onclick="sendChat()">â¤</button>
    </div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>